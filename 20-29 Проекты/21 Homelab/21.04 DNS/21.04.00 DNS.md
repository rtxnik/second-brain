# 21.04.00 DNS

> BIND9 DNS инфраструктура

## Содержание

| Заметка                               | Описание                         |
| ------------------------------------- | -------------------------------- |
| [[21.04.01 BIND9 Полное руководство]] | Установка, настройка, управление |
| [[21.04.02 DNS Шпаргалка]]            | Быстрый справочник команд        |
| [[21.04.03 DNS Шаблоны]]              | Шаблоны конфигурации зон         |

---

## Архитектура

```
┌─────────────────────────────────────────────────────┐
│                    DNS Infrastructure                │
├──────────────────────────┬──────────────────────────┤
│   dns-01.rtxlab.local    │   dns-02.rtxlab.local    │
│   10.0.20.11 (Master)    │   10.0.20.12 (Slave)     │
│                          │                          │
│   - Authoritative для    │   - Получает зоны через  │
│     всех зон             │     AXFR/IXFR            │
│   - Источник изменений   │   - Read-only реплика    │
│   - Отправляет NOTIFY    │   - Автоматическая синхр.│
└──────────────────────────┴──────────────────────────┘
```

---

## DNS зоны

| Зона                 | Тип      | Назначение                   |
| -------------------- | -------- | ---------------------------- |
| rtxlab.local         | Прямая   | Основная зона инфраструктуры |
| k8s.rtxlab.local     | Прямая   | Kubernetes поддомен          |
| 20.0.10.in-addr.arpa | Обратная | PTR записи для 10.0.20.0/24  |

---

## Серверы

| Hostname | IP         | Роль   | Proxmox Node   |
| -------- | ---------- | ------ | -------------- |
| dns-01   | 10.0.20.11 | Master | pve-compute-01 |
| dns-02   | 10.0.20.12 | Slave  | pve-compute-02 |

### Спецификация VM

```
OS:   Ubuntu 24.04 LTS
CPU:  2 cores
RAM:  2GB
Disk: 20GB
```

---

## Быстрые команды

```bash
# Проверка резолвинга
dig @10.0.20.11 api.k8s.rtxlab.local

# Проверка Serial (репликация)
dig @10.0.20.11 k8s.rtxlab.local SOA +short
dig @10.0.20.12 k8s.rtxlab.local SOA +short

# Reload зоны после изменений
sudo rndc reload k8s.rtxlab.local
```

---

## Статус

- [x] dns-01 (Master) настроен
- [x] dns-02 (Slave) настроен
- [x] Зоны созданы и реплицируются
- [x] OPNsense форвардит на BIND
- [ ] DNS записи для K8s кластеров добавлены

---

Дата создания: 02-12-2025 18:22

#### Ссылки:

[[21.00 Homelab]]
[[21.02.02 IP адресация]]
