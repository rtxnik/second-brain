# 21.00 Homelab

> Домашняя лаборатория Kubernetes на базе Proxmox

## Быстрая навигация

| Раздел                     | Описание                       |
| -------------------------- | ------------------------------ |
| [[21.01.00 Инвентарь]]     | Оборудование, спецификации     |
| [[21.02.00 Сеть]]          | VLANs, IP адресация, топология |
| [[21.03.00 Proxmox]]       | Кластер виртуализации, Ceph    |
| [[21.04.00 DNS]]           | BIND9 инфраструктура           |
| [[21.05.00 Kubernetes]]    | K8s кластеры (Prod + Test)     |
| [[21.06.00 Сервисы]]       | Приложения и сервисы           |
| [[21.07.00 Автоматизация]] | OpenTofu, Ansible              |
| [[21.08.00 Операции]]      | UPS, Backup, Runbooks          |
| [[21.09.00 Планирование]]  | Roadmap, планы                 |

---

## Архитектура

```
┌─────────────────────────────────────────────────────────────────┐
│                        HOMELAB STACK                             │
├─────────────────────────────────────────────────────────────────┤
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                    KUBERNETES LAYER                       │   │
│  │  ┌─────────────────────┐  ┌─────────────────────┐        │   │
│  │  │  Production Cluster │  │    Test Cluster     │        │   │
│  │  │  (76GB, 26 vCPU)    │  │  (30GB, 16 vCPU)    │        │   │
│  │  └─────────────────────┘  └─────────────────────┘        │   │
│  └──────────────────────────────────────────────────────────┘   │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                   VIRTUALIZATION LAYER                    │   │
│  │  ┌────────────────┐ ┌────────────────┐ ┌──────────────┐  │   │
│  │  │ pve-compute-01 │ │ pve-compute-02 │ │pve-compute-03│  │   │
│  │  │   Proxmox VE   │ │   Proxmox VE   │ │  Proxmox VE  │  │   │
│  │  │   + Ceph OSD   │ │   + Ceph OSD   │ │  + Ceph OSD  │  │   │
│  │  └────────────────┘ └────────────────┘ └──────────────┘  │   │
│  └──────────────────────────────────────────────────────────┘   │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                     NETWORK LAYER                         │   │
│  │  OPNsense (Firewall) ←→ MikroTik (Switch) ←→ VLANs       │   │
│  └──────────────────────────────────────────────────────────┘   │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                     STORAGE LAYER                         │   │
│  │  Ceph (3.8TB) │ TrueNAS (~1.9TB) │ Longhorn (K8s PV)     │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
```

---

## Текущий статус

| Компонент       | Статус           |
| --------------- | ---------------- |
| Proxmox Cluster | ✅ Работает      |
| Ceph Storage    | ✅ Работает      |
| Network (VLANs) | ✅ Настроено     |
| DNS (BIND)      | ✅ Работает      |
| VM Template     | ⏳ В процессе    |
| Test K8s        | 📋 Следующий шаг |
| Prod K8s        | 📋 Планируется   |

---

## Ресурсы кластера

| Ресурс         | Всего   | Выделено K8s  | Резерв |
| -------------- | ------- | ------------- | ------ |
| RAM            | 288GB   | ~106GB        | ~128GB |
| vCPU           | 60c/84t | ~42           | ~18    |
| Storage (Ceph) | 3.8TB   | По требованию | —      |

---

## Следующие шаги

1. [[21.03.03 VM Templates]] — Создать Ubuntu template
2. [[21.05.04 DNS записи K8s]] — Добавить DNS записи
3. [[21.05.02 Test Cluster]] — Развернуть Test K8s
4. [[21.05.01 Production Cluster]] — Развернуть Prod K8s

---

Дата создания: 02-12-2025 18:22

#### Ссылки:
