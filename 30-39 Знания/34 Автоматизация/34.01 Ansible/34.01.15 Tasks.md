# 34.01.15 Tasks

Ansible Tasks — атомарные операции, вызывающие модули.

## Структура задачи

```yaml
- name: "Install and configure nginx"
  ansible.builtin.apt:
    name: nginx
    state: present
  become: true
  when: ansible_os_family == "Debian"
  register: install_result
  notify: restart nginx
  tags:
    - install
    - webserver
```

## Условия

```yaml
- name: "Install on Ubuntu"
  ansible.builtin.apt:
    name: nginx
  when: ansible_distribution == "Ubuntu"

- name: "Skip if variable undefined"
  ansible.builtin.debug:
    msg: "Value defined"
  when: my_var is defined
```

## Регистрация результатов

```yaml
- name: "Check if service exists"
  ansible.builtin.stat:
    path: /etc/systemd/system/myapp.service
  register: service_file

- name: "Start if exists"
  ansible.builtin.service:
    name: myapp
    state: started
  when: service_file.stat.exists
```

## Делегирование

```yaml
- name: "Update load balancer"
  ansible.builtin.template:
    src: haproxy.cfg.j2
    dest: /etc/haproxy/haproxy.cfg
  delegate_to: loadbalancer
```

---

Дата создания: 2025-12-01

Ссылки:

[[34.01.00 Ansible]]
[[34.01.11 Modules]]
[[34.01.13 Playbook]]
[[34.01.20 Handlers]]
