# 34.01.14 Roles

Ansible Roles — переиспользуемые наборы задач, переменных и файлов.

## Структура роли

```
roles/nginx/
├── defaults/main.yml    # переменные по умолчанию
├── vars/main.yml        # переменные роли
├── tasks/main.yml       # основные задачи
├── handlers/main.yml    # обработчики
├── templates/           # шаблоны Jinja2
├── files/               # статические файлы
├── meta/main.yml        # метаданные и зависимости
└── README.md
```

## Использование

```yaml
- hosts: webservers
  become: true
  roles:
    - nginx
    - role: mysql
      vars:
        mysql_root_password: "secret"
```

## Создание роли

```bash
ansible-galaxy init nginx
```

## Зависимости

```yaml
# meta/main.yml
dependencies:
  - role: common
  - role: firewall
    vars:
      allowed_ports: [80, 443]
```

## Именование переменных

```yaml
# Хорошо — с префиксом роли
nginx_port: 80
nginx_user: www-data

# Плохо — без контекста
port: 80
user: www-data
```

---

Дата создания: 2025-12-01

Ссылки:

[[34.01.00 Ansible]]
[[34.01.13 Playbook]]
[[34.01.18 Galaxy]]
