# 34.01.21 Conditionals

Conditionals позволяют выполнять задачи при определённых условиях через директиву `when`.

## Базовые условия

```yaml
- name: "Install on Ubuntu"
  ansible.builtin.apt:
    name: nginx
  when: ansible_distribution == "Ubuntu"

- name: "Configure SSL if enabled"
  ansible.builtin.template:
    src: ssl.conf.j2
    dest: /etc/nginx/ssl.conf
  when: ssl_certificate is defined
```

## Сложные условия

```yaml
- name: "Install on Ubuntu 20.04+"
  ansible.builtin.apt:
    name: modern-package
  when: 
    - ansible_distribution == "Ubuntu"
    - ansible_distribution_version is version("20.04", ">=")

- name: "Install on Debian family"
  ansible.builtin.apt:
    name: package
  when: ansible_os_family in ["Debian", "Ubuntu"]
```

## Условия на результатах

```yaml
- name: "Check if service exists"
  ansible.builtin.stat:
    path: /etc/systemd/system/myapp.service
  register: service_file

- name: "Start if exists"
  ansible.builtin.service:
    name: myapp
    state: started
  when: service_file.stat.exists
```

## Условия для групп

```yaml
- name: "Configure load balancer"
  ansible.builtin.template:
    src: haproxy.cfg.j2
    dest: /etc/haproxy/haproxy.cfg
  when: inventory_hostname in groups['loadbalancers']
```

---

Дата создания: 2025-12-01

Ссылки:

[[34.01.00 Ansible]]
[[34.01.15 Tasks]]
[[34.01.19 Facts]]
