# 34.01.17 Templates

Ansible Templates генерируют файлы на основе переменных через Jinja2.

## Синтаксис Jinja2

**Переменные:**
```jinja2
server_name {{ server_name }};
listen {{ http_port }};
host {{ database.host }}
```

**Условия:**
```jinja2
{% if ssl_enabled %}
listen 443 ssl;
ssl_certificate {{ ssl_cert_path }};
{% endif %}

debug {{ 'on' if debug_mode else 'off' }};
```

**Циклы:**
```jinja2
{% for server in nginx_servers %}
server {
    listen {{ server.port }};
    server_name {{ server.name }};
}
{% endfor %}
```

## Пример nginx.conf.j2

```jinja2
user {{ nginx_user }};
worker_processes {{ ansible_processor_vcpus }};

events {
    worker_connections {{ worker_connections | default(1024) }};
}
```

## Использование

```yaml
- name: "Deploy nginx configuration"
  ansible.builtin.template:
    src: nginx.conf.j2
    dest: /etc/nginx/nginx.conf
    backup: true
  notify: restart nginx
```

## Фильтры

```jinja2
timeout {{ connection_timeout | default(30) }}
packages: {{ list | join(', ') }}
```

---

Дата создания: 2025-12-01

Ссылки:

[[34.01.00 Ansible]]
[[34.01.16 Variables]]
[[34.01.11 Modules]]
