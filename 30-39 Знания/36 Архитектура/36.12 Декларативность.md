# 36.12 Декларативность

Декларативное программирование описывает желаемый результат без указания способа его достижения. **Декларативный подход определяет "что" нужно получить, оставляя решение "как" это сделать системе выполнения, что обеспечивает более высокий уровень абстракции**.

Вместо пошаговых инструкций программист описывает конечное состояние или набор правил. Система автоматически определяет необходимые действия для достижения заданного состояния.

## Характеристики

- Описание результата вместо процесса
- Абстракция деталей реализации от программиста
- Встроенная [[36.13 Идемпотентность|идемпотентность]] выполнения
- Неизменяемость данных и конфигураций
- Композиция сложных решений из простых частей

## Применение в DevOps

**Configuration Management** через [[34.01.00 Ansible|Ansible]], Chef, Puppet представляет классический пример декларативного подхода. Ansible playbook описывает желаемое состояние системы - какие пакеты должны быть установлены, какие сервисы запущены, какие файлы размещены. Система сама определяет необходимые действия.

**Infrastructure as Code** через Terraform, CloudFormation, ARM templates позволяет описывать инфраструктуру декларативно.

**Container Orchestration** в Kubernetes использует YAML манифесты для описания желаемого состояния приложений.

**Policy as Code** через Open Policy Agent, HashiCorp Sentinel определяет правила безопасности декларативно.

## Примеры декларативного подхода

### Ansible Playbook

```yaml
- name: Ensure web server is configured
  hosts: webservers
  tasks:
    - name: nginx is installed
      package:
        name: nginx
        state: present

    - name: nginx is running
      service:
        name: nginx
        state: started
        enabled: yes
```

### Kubernetes Deployment

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: web-app
spec:
  replicas: 3
  selector:
    matchLabels:
      app: web
  template:
    spec:
      containers:
        - name: web
          image: nginx:latest
```

### SQL Query

```sql
SELECT name, email
FROM users
WHERE age > 25
ORDER BY name;
```

## Self-healing и Reconciliation

Декларативные системы работают по принципу конвергенции - автоматически приводят состояние к желаемому:

- **Self-healing** - автоматическое восстановление при отклонениях
- **Desired State Management** - поддержка заданной конфигурации
- **Reconciliation loop** - постоянное сравнение текущего и желаемого состояния

## Преимущества

- Интуитивное описание желаемого состояния
- Безопасное повторное выполнение благодаря идемпотентности
- Меньше ошибок из-за автоматизации деталей
- Лучшая абстракция для фокуса на бизнес-логике
- Переносимость между платформами

## Недостатки

- Ограниченный контроль над деталями выполнения
- Сложность отладки внутренних процессов "черного ящика"
- Возможно менее эффективная производительность
- Необходимость изучения конкретной декларативной системы

## Эволюция подходов

Современные DevOps практики часто комбинируют оба подхода - декларативную инфраструктуру с императивными скриптами развертывания, декларативные политики с императивной обработкой исключений.

Тренды: GitOps (инфраструктура в Git), Policy as Code, Serverless.

---

Дата создания: 2025-12-01
Ссылки:

[[36.00 Архитектура]]
[[36.11 Императивность]]
[[36.13 Идемпотентность]]
[[34.01.00 Ansible]]
