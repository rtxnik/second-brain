# 34.01.23 Vault

Ansible Vault обеспечивает шифрование конфиденциальных данных через AES256.

## Команды

```bash
ansible-vault create secrets.yml   # создать зашифрованный
ansible-vault encrypt vars.yml     # зашифровать существующий
ansible-vault edit secrets.yml     # редактировать
ansible-vault decrypt secrets.yml  # расшифровать
ansible-vault rekey secrets.yml    # сменить пароль
```

## Использование

```yaml
# В playbook
- hosts: webservers
  vars_files:
    - vars/common.yml
    - secrets.yml
  tasks:
    - name: "Configure database"
      ansible.builtin.template:
        src: database.conf.j2
        dest: /etc/myapp/database.conf
```

## Запуск playbook

```bash
# Интерактивный ввод пароля
ansible-playbook site.yml --ask-vault-pass

# Файл с паролем
ansible-playbook site.yml --vault-password-file .vault_pass
```

## Организация секретов

```
group_vars/
├── all/
│   ├── vars.yml      # публичные
│   └── vault.yml     # зашифрованные
└── production/
    └── vault.yml
```

## Именование

```yaml
# Хорошо — ссылка на vault
database_password: "{{ vault_db_pass }}"

# В vault.yml
vault_db_pass: "secret_password"
```

---

Дата создания: 02-12-2025 18:22

#### Ссылки:

[[34.01.00 Ansible]]
[[34.01.16 Variables]]
[[34.01.13 Playbook]]
