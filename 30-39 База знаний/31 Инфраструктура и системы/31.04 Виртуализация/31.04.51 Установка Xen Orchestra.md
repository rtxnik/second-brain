# 31.04.51 Установка Xen Orchestra

Установка [[31.04.03 Xen Orchestra]] из исходного кода (XO from Sources) — бесплатная версия с полным функционалом.

## Подготовка VM

**На XCP-ng создать VM:**

- OS: Ubuntu 20.04 LTS
- CPU: 2 vCPU
- RAM: 4GB
- Storage: 40GB
- Network: Management

**Базовая настройка:**

```bash
sudo apt update && sudo apt upgrade -y
sudo apt install curl git build-essential redis-server libpng-dev -y
sudo hostnamectl set-hostname xen-orchestra
```

## Установка Node.js

```bash
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

node --version  # v18.x.x
npm --version   # 8.x.x+
```

## Установка Yarn

```bash
curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
sudo apt update && sudo apt install yarn -y
```

## Сборка XO

```bash
cd /home/ubuntu
git clone -b master https://github.com/vatesfr/xen-orchestra
cd xen-orchestra
yarn
yarn build
```

## Конфигурация

```bash
cd packages/xo-server
cp sample.config.yaml .xo-server.yaml
nano .xo-server.yaml
```

**Настройки:**

```yaml
http:
  listen:
    - ip: "::"
      port: 80
  mounts:
    "/": "../xo-web/dist/"

redis:
  uri: "redis://localhost:6379/0"
```

## Systemd сервис

```bash
sudo nano /etc/systemd/system/xo-server.service
```

```ini
[Unit]
Description=Xen Orchestra Server
After=network.target

[Service]
Type=simple
User=ubuntu
WorkingDirectory=/home/ubuntu/xen-orchestra/packages/xo-server
ExecStart=/usr/bin/node ./bin/xo-server
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

**Запуск:**

```bash
sudo systemctl daemon-reload
sudo systemctl enable xo-server
sudo systemctl start xo-server
sudo systemctl status xo-server
```

## Первое подключение

**Браузер:** `http://192.168.1.101`

**Создать пользователя:**

- Email: admin@example.com
- Password: (надёжный пароль)

**Добавить XCP-ng хост:**
Settings → Servers → Add

- Label: XCP-ng Host 1
- Host: 192.168.1.100
- Username: root
- Password: (пароль XCP-ng)

## Обновление

```bash
sudo systemctl stop xo-server
cd /home/ubuntu/xen-orchestra
git pull
yarn
yarn build
sudo systemctl start xo-server
```

---

Дата создания: 02-12-2025 18:22

#### Ссылки:

[[31.04.00 Виртуализация]]
[[31.04.03 Xen Orchestra]]
[[31.04.50 Установка XCP-ng]]
